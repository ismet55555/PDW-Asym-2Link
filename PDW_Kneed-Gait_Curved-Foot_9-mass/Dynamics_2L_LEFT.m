function [qdd] = Dynamics_2L_LEFT(q1, q1d, q2, q2d , rLa, rLb, dL, rRa, rRb, dR, parameters, psi)
%This funciton describes the dynamics during left stance

mt1R = parameters(1);      mt1L = parameters(14); 
mt2R = parameters(2);      mt2L = parameters(15); 
ms2R = parameters(3);      ms2L = parameters(16);
ms1R = parameters(4);      ms1L = parameters(17);
a1R  = parameters(5);      a1L  = parameters(18);
b1R  = parameters(6);      b1L  = parameters(19); 
c1R  = parameters(7);      c1L  = parameters(20);
c2R  = parameters(8);      c2L  = parameters(21);
b2R  = parameters(9);      b2L  = parameters(22);
a2R  = parameters(10);     a2L  = parameters(23);  
lsR  = parameters(11);     lsL  = parameters(24);
ltR  = parameters(12);     ltL  = parameters(25);
LR   = parameters(13);     LL   = parameters(26);

mh   = parameters(27);

g     = parameters(28);     
dt    = parameters(29);    
theta = parameters(30);




%Inertia Matrix:     
M11 = (ms2L*(2*cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mt2L*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))^2*((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))^2*((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mh*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (ms1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (ms2R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mt1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mt2R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (ms1L*(2*cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mt1L*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2;
M12 = - (mt1R*(2*a2R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*a2R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt2R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(a2R + b2R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(a2R + b2R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms2R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2;
M21 = M12;
M22 = (ms1R*(2*cos(q2)^2*(b1R + c1R + ltR)^2 + 2*sin(q2)^2*(b1R + c1R + ltR)^2))/2 + (mt2R*(2*cos(q2)^2*(a2R + b2R)^2 + 2*sin(q2)^2*(a2R + b2R)^2))/2 + (ms2R*(2*cos(q2)^2*(c1R + ltR)^2 + 2*sin(q2)^2*(c1R + ltR)^2))/2 + (mt1R*(2*a2R^2*cos(q2)^2 + 2*a2R^2*sin(q2)^2))/2;

M = [M11, M12;  M21, M22];




%Velocity Matrix:
N11_qd_2 = (mh*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (mh*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (ms1R*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms2R*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt1R*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt2R*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (ms1L*(cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (ms1L*(2*cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (ms2L*(cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) + sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 - (ms2L*(2*cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) + 2*sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 + (ms1R*(2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (ms2R*(2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (mt1R*(2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (mt2R*(2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (mt2L*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 - (mt2L*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 + (mt1L*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))*(2*b2L + 2*c2L + 2*lsL))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))*(2*b2L + 2*c2L + 2*lsL))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))))/2 - (mt1L*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))*(2*b2L + 2*c2L + 2*lsL))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))*(2*b2L + 2*c2L + 2*lsL))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))))/2;
N12_qd_2 = (mt1R*(2*a2R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*a2R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (ms1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (mt2R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(a2R + b2R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(a2R + b2R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (ms2R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2;
N21_qd_2 = (ms1R*(2*cos(q2)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*(b1R + c1R + ltR) + 2*sin(q2)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*(b1R + c1R + ltR)))/2 + (mt2R*(2*cos(q2)*(a2R + b2R)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(q2)*(a2R + b2R)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (ms2R*(2*cos(q2)*(c1R + ltR)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(q2)*(c1R + ltR)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (mt1R*(2*a2R*cos(q2)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*a2R*sin(q2)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2;
N22_qd_2 = 0;

N_qd_2  = [N11_qd_2, N12_qd_2;   N21_qd_2, N22_qd_2];

N11_qd = (ms1R*((q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R + ltR)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R + ltR)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt2R*(2*q2d*cos(q2)*(a2R + b2R)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*q2d*sin(q2)*(a2R + b2R)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (ms2R*(2*q2d*cos(q2)*(c1R + ltR)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*q2d*sin(q2)*(c1R + ltR)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (ms1R*(2*q2d*cos(q2)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*(b1R + c1R + ltR) + 2*q2d*sin(q2)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*(b1R + c1R + ltR)))/2 + (mt1R*(2*a2R*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*a2R*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a2R*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a2R*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (mt2R*(2*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(a2R + b2R)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(a2R + b2R)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(a2R + b2R)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(a2R + b2R)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt1R*(2*a2R*q2d*cos(q2)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*a2R*q2d*sin(q2)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (ms2R*(2*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(c1R + ltR)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(c1R + ltR)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(c1R + ltR)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(c1R + ltR)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2;
N12_qd = (ms1R*(2*sin(q2)*(q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(b1R + c1R + ltR) - 2*cos(q2)*(q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(b1R + c1R + ltR)))/2 - (ms1R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R + ltR)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R + ltR)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*(b1R + c1R + ltR)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt2R*(2*cos(q2)*(a2R + b2R)*(q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) - 2*sin(q2)*(a2R + b2R)*(q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 - (mt1R*((a2R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a2R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*a2R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*a2R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms2R*(2*cos(q2)*(q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(c1R + ltR) - 2*sin(q2)*(q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(c1R + ltR)))/2 - (mt2R*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(a2R + b2R)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(a2R + b2R)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(a2R + b2R)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(a2R + b2R)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms2R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(c1R + ltR)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(c1R + ltR)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(c1R + ltR)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(c1R + ltR)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt1R*(2*a2R*cos(q2)*(q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) - 2*a2R*sin(q2)*(q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2;
N21_qd = 0;
N22_qd = 0;

N_qd     = [N11_qd, N12_qd;  N21_qd, N22_qd];




%Gravity Matrix:
G11 = -g*(ms1R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + ms2R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + mt1R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + mt2R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + (ms2L*cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/(2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - ms1L*sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(3/2)))/(1 - (a1L^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^(1/2))*((rLa + q1*rLb)^2 + a1L^2 + dL^2 - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + mh*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - mt1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)*(((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))*(2*b2L + 2*c2L + 2*lsL))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL)))/(2*((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(3/2)) + (cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2))/(1 - (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2*(b2L + c2L + lsL)^2)/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL)))^(1/2) - ((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - ms2L*sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/(2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(3/2)))/(1 - (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2*(a1L + b1L)^2)/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^(1/2))*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - mt2L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))*(((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/(2*((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(3/2)) + (cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2))/(1 - (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2*(c2L + lsL)^2)/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^(1/2) - ((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (mh*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + (mt2L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(c2L + lsL))/((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)))*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/(2*((rLa + q1*rLb)^2 + (c2L + lsL)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*c2L + 2*lsL)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) + (ms1L*cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) + (mt1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(b2L + c2L + lsL))/((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))*(2*b2L + 2*c2L + 2*lsL))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL)))/(2*((rLa + q1*rLb)^2 + dL^2 + (b2L + c2L + lsL)^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)*(2*b2L + 2*c2L + 2*lsL))^(1/2)));
G21 = g*(a2R*mt1R*sin(q2) + ms1R*sin(q2)*(b1R + c1R + ltR) + mt2R*sin(q2)*(a2R + b2R) + ms2R*sin(q2)*(c1R + ltR));

G = [G11; G21];




%Hip Joint Damping
Damp_Hip_L = 0;
C = [Damp_Hip_L/2; Damp_Hip_L/2] .* [q1d; q2d] ;

%Hip Joint Stiffness
Stiff_Hip_L = 0;
K = [Stiff_Hip_L/2; Stiff_Hip_L/2] .* [q1; q2] ;






%Angular Accelerations
qdd = -inv(M) * (N_qd_2*[q1d; q2d].^2 + N_qd*[q1d; q2d] + G  + C + K);



end

