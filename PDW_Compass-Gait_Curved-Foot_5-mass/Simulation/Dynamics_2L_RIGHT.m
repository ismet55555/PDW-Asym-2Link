function [qdd] = Dynamics_2L_RIGHT(q1, q1d, q2, q2d, p, psi)
%This funciton describes the dynamics during right stance

% WARNING: Due to its variables numbers, better to edit in a non-MATLAB text editor!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%    Assigning all Incoming Parameters    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
g     = p.sim.g;
theta = p.sim.theta;

mh   = p.walker.hip.mh;

mt1L = p.walker.left.mt1L;
ms1L = p.walker.left.ms1L;
a1L  = p.walker.left.a1L;
b1L  = p.walker.left.b1L;
c1L  = p.walker.left.c1L;

mt1R = p.walker.right.mt1R;
ms1R = p.walker.right.ms1R;
a1R  = p.walker.right.a1R;
b1R  = p.walker.right.b1R;
c1R  = p.walker.right.c1R;

LR  = p.walker.right.LR;

rRa = p.walker.right.rRa;
rRb = p.walker.right.rRb;
dR  = p.walker.right.dR;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Intertia Matrix    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
M11 = (mt1R*(2*cos(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)) + 2*sin(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))))/2 + (mh*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))))/2 + (ms1L*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))))/2 + (mt1L*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))))/2 + (ms1R*(2*cos(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*((rRa + q1*rRb)^2 + a1R^2 + dR^2 - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)) + 2*sin(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*((rRa + q1*rRb)^2 + a1R^2 + dR^2 - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))))/2;
M12 = - (mt1L*(2*c1L*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*c1L*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 - (ms1L*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(b1L + c1L)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(b1L + c1L)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2;
M21 = M12;
M22 = (ms1L*(2*cos(q2)^2*(b1L + c1L)^2 + 2*sin(q2)^2*(b1L + c1L)^2))/2 + (mt1L*(2*c1L^2*cos(q2)^2 + 2*c1L^2*sin(q2)^2))/2;

M = [M11, M12; 
     M21, M22];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Velocity Matrix    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
N11_qd_2 = (mh*(cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 - (mh*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 + (ms1R*(cos(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 - (ms1R*(2*cos(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*sin(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 + (mt1R*(cos(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))) + sin(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))))/2 - (mt1R*(2*cos(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))) + 2*sin(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))))/2 - (ms1L*(cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 - (mt1L*(cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)^2*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 + (ms1L*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 + (mt1L*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2;
N12_qd_2 = (mt1L*(2*c1L*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - 2*c1L*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 + (ms1L*(2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(b1L + c1L)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(b1L + c1L)*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2;
N21_qd_2 = (mt1L*(2*c1L*cos(q2)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*c1L*sin(q2)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 + (ms1L*(2*cos(q2)*(b1L + c1L)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*sin(q2)*(b1L + c1L)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2;
N22_qd_2 = 0;

N_qd_2  = [N11_qd_2, N12_qd_2;   
           N21_qd_2, N22_qd_2];

N11_qd = (mt1L*(2*c1L*q2d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - 2*c1L*q2d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (c1L*q2d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (c1L*q2d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 - (ms1L*(2*q2d*cos(q2)*(b1L + c1L)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*q2d*sin(q2)*(b1L + c1L)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 + (ms1L*(2*q2d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(b1L + c1L)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - 2*q2d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(b1L + c1L)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (q2d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(b1L + c1L)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (q2d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(b1L + c1L)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 - (mt1L*(2*c1L*q2d*cos(q2)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*c1L*q2d*sin(q2)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2;
N12_qd = - (ms1L*(2*cos(q2)*(b1L + c1L)*(q1d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (q1d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))) - 2*sin(q2)*(b1L + c1L)*(q1d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (q1d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))))/2 - (mt1L*((c1L*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (c1L*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*c1L*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) + ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - 2*c1L*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) + ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 - (ms1L*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(b1L + c1L)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(b1L + c1L)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*sin(q2)*(b1L + c1L)*(((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) + ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - 2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*cos(q2)*(b1L + c1L)*(((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) + ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2)))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(2*q1d*rRb*(rRa + q1*rRb) - (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dR*q1d*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*q1d*rRb*(rRa + q1*rRb) + 2*dR*q1d*rRb*cos(pi/2 + q1 - theta) - dR*q1d*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/2 - (mt1L*(2*c1L*cos(q2)*(q1d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (q1d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))) - 2*c1L*sin(q2)*(q1d*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (q1d*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))))/2;
N21_qd = 0;
N22_qd = 0;

N_qd     = [N11_qd,      N12_qd;
            N21_qd,      N22_qd];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Gravity Matrix    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
G11 = -g*(ms1L*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + mt1L*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + (mt1R*cos(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/(2*((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - ms1R*sin(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(3/2)))/(1 - (a1R^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^(1/2))*((rRa + q1*rRb)^2 + a1R^2 + dR^2 - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + mh*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - mt1R*sin(theta + asin((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(a1R + b1R))/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(a1R + b1R)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/(2*((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(3/2)))/(1 - (sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2*(a1R + b1R)^2)/((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))^(1/2))*((rRa + q1*rRb)^2 + (a1R + b1R)^2 + dR^2 - sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*a1R + 2*b1R)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (mh*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + (ms1R*cos(theta + asin((a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)) - asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*a1R*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + a1R^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*a1R*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))^(1/2)));
G21 = g*(c1L*mt1L*sin(q2) + ms1L*sin(q2)*(b1L + c1L));

G = [G11;
     G21];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   Hip Joint Damping   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
Damp_Hip_R = 0;
C = [Damp_Hip_R/2; Damp_Hip_R/2] .* [q1d; q2d] ;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   Hip Joint Stiffness   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Stiff_Hip_R = 0;
K = [Stiff_Hip_R/2; Stiff_Hip_R/2] .* [q1; q2] ;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Calculate Angular Acceleration    %%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
qdd = -inv(M) * (N_qd_2*[q1d; q2d].^2 + N_qd*[q1d; q2d] + G  + C + K);

end


