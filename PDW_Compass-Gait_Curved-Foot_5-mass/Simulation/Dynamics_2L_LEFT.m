function [qdd] = Dynamics_2L_LEFT(q1, q1d, q2, q2d, p, psi)
% This funciton describes the dynamics during left stance
%
% WARNING: Due to its variables numbers, better to edit in a non-MATLAB text editor!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%    Assigning all Incoming Parameters    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
g     = p.sim.g;
theta = p.sim.theta;

mh   = p.walker.hip.mh;

mt1L = p.walker.left.mt1L;
ms1L = p.walker.left.ms1L;
a1L  = p.walker.left.a1L;
b1L  = p.walker.left.b1L;
c1L  = p.walker.left.c1L;

mt1R = p.walker.right.mt1R;
ms1R = p.walker.right.ms1R;
a1R  = p.walker.right.a1R;
b1R  = p.walker.right.b1R;
c1R  = p.walker.right.c1R;

LL  = p.walker.left.LL;

rLa = p.walker.left.rLa;
rLb = p.walker.left.rLb;
dL  = p.walker.left.dL;



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Intertia Matrix    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
M11 = (mt1L*(2*cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mh*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (ms1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (mt1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2 + (ms1L*(2*cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)) + 2*sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))))/2;
M12 = - (mt1R*(2*c1R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*c1R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2;
M21 = M12;
M22 = (ms1R*(2*cos(q2)^2*(b1R + c1R)^2 + 2*sin(q2)^2*(b1R + c1R)^2))/2 + (mt1R*(2*c1R^2*cos(q2)^2 + 2*c1R^2*sin(q2)^2))/2;

M = [M11, M12;
     M21, M22];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Velocity Matrix    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
N11_qd_2 = (mh*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (mh*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (ms1R*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt1R*(cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (ms1L*(cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 - (ms1L*(2*cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (mt1L*(cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) + sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 - (mt1L*(2*cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) + 2*sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^2*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 + (ms1R*(2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (mt1R*(2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2;
N12_qd_2 = (mt1R*(2*c1R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*c1R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 + (ms1R*(2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R)*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2;
N21_qd_2 = (ms1R*(2*cos(q2)*(b1R + c1R)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(q2)*(b1R + c1R)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (mt1R*(2*c1R*cos(q2)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*c1R*sin(q2)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2;
N22_qd_2 = 0;

N_qd_2  = [N11_qd_2, N12_qd_2;
           N21_qd_2, N22_qd_2];

N11_qd = (mt1R*(2*c1R*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*c1R*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (c1R*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (c1R*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms1R*(2*q2d*cos(q2)*(b1R + c1R)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*q2d*sin(q2)*(b1R + c1R)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (ms1R*(2*q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q2d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt1R*(2*c1R*q2d*cos(q2)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*c1R*q2d*sin(q2)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2;
N12_qd = - (ms1R*(2*cos(q2)*(b1R + c1R)*(q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) - 2*sin(q2)*(b1R + c1R)*(q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2 - (mt1R*((c1R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (c1R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*c1R*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*c1R*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (ms1R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*sin(q2)*(b1R + c1R)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - 2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*cos(q2)*(b1R + c1R)*(((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) + ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2)))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(2*q1d*rLb*(rLa + q1*rLb) - (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(q1d - ((dL*q1d*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*q1d*rLb*(rLa + q1*rLb) + 2*dL*q1d*rLb*cos(pi/2 + q1 - theta) - dL*q1d*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/2 - (mt1R*(2*c1R*cos(q2)*(q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))) - 2*c1R*sin(q2)*(q1d*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (q1d*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))))/2;
N21_qd = 0;
N22_qd = 0;

N_qd     = [N11_qd, N12_qd;
            N21_qd, N22_qd];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Gravity Matrix    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
G11 = -g*(ms1R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + mt1R*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + (mt1L*cos(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/(2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - ms1L*sin(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(3/2)))/(1 - (a1L^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^(1/2))*((rLa + q1*rLb)^2 + a1L^2 + dL^2 - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + mh*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - mt1L*sin(theta + asin((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(a1L + b1L))/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(a1L + b1L)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/(2*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(3/2)))/(1 - (sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2*(a1L + b1L)^2)/((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))^(1/2))*((rLa + q1*rLb)^2 + (a1L + b1L)^2 + dL^2 - sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*a1L + 2*b1L)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (mh*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + (ms1L*cos(theta + asin((a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)) - asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*a1L*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + a1L^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*a1L*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))^(1/2)));
G21 = g*(c1R*mt1R*sin(q2) + ms1R*sin(q2)*(b1R + c1R));

G = [G11;
     G21];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   Hip Joint Damping   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% Units: N*m*s / rad)
Damp_Hip_L = 0;
C = [Damp_Hip_L/2; Damp_Hip_L/2] .* [q1d; q2d] ;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   Hip Joint Stiffness   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Stiff_Hip_L = 0;
K = [Stiff_Hip_L/2; Stiff_Hip_L/2] .* [q1; q2] ;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Calculate Angular Acceleration    %%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
qdd = -inv(M) * (N_qd_2*[q1d; q2d].^2 + N_qd*[q1d; q2d] + G + C + K);

end

