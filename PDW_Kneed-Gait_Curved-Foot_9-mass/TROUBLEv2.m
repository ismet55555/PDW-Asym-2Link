clear all
close all
clc


mt1R = 10;      mt1L = 10; 
mt2R = 20;      mt2L = 30; 
ms2R = 30;      ms2L = 30;
ms1R = 40;      ms1L = 40;
a1R  = 50;      a1L  = 70;
b1R  = 60;      b1L  = 60; 
c1R  = 70;      c1L  = 70;
c2R  = 80;      c2L  = 80;
b2R  = 90;      b2L  = 90;
a2R  = 10;       a2L  = 10;  

lsL = a1L+b1L+c1L;  
ltL = a2L+b2L+c2L;
LL = lsL+ltL;

lsR = a1R+b1R+c1R;
ltR = a2R+b2R+c2R;
LR = lsR+ltR;

mh   = 3;


q1 = 1;
q2 = 1;
q3 = 1;

q1d = 1;
q2d = 1;
q3d = 1;


g     = 1;     
dt    = 1;    
theta = asin(8.55/144);

% syms a1L b1L c1L c2L b2L a2L  LL
% syms a1R b1R c1R c2R b2R a2R  LR
% 
% syms ms1L ms2L mt2L mt1L   mh   
% syms ms1R ms2R mt2R mt1R
% 
% syms  q1 q1d q1dd  g
% syms  q2 q2d q2dd
% syms  q3 q3d q3dd

rLa = 100;
rLb = 100;
rL  = 100;
dL  = 10.00000000000000000000000000000001; 

rRa = 100;
rRb = 100;
rR  = 100;
dR  = 10.00000000000000000000000000000001;

% dm_a1L = a1L;                    
% psi_a1L = q1;
% dm_a1Lb1L = a1L + b1L;                    
% psi_a1Lb1L = q1;
% dm_lsLc2L = a1L + b1L + c1L + c2L; 
% psi_lsLc2L = q1;
% dm_lsLc2Lb2L = a1L + b1L + c1L + c2L + b2L; 
% psi_lsLc2Lb2L = q1;
% dm_LL = LL;                   
% psi_LL = q1;
% dm_a1R = a1R;                    
% psi_a1R = q2;
% dm_a1Rb1R = a1R + b1R;                   
% psi_a1Rb1R = q2;
% dm_lsRc2R = a1R + b1R + c1R + c2R; 
% psi_lsRc2R = q2;
% dm_lsRc2Rb2R = a1R + b1R + c1R + c2R + b2R; 
% psi_lsRc2Rb2R =q2;
% dm_LR = LR;                    
% psi_LR = q2;


d_a = sqrt(rL^2 + dL^2 + 2*rL*dL*cos(pi/2 + q1 - theta));
phi = asin( (dL*sin(pi/2 + q1 - theta)) / d_a);
theta_a = pi/2 - phi + q1 + theta;

%ms1L at (a1L) (lower shank)
dm_a1L = sqrt((a1L)^2 + d_a^2 + 2*(a1L)*d_a*sin(theta_a));                    
beta_a1L = -asin(((a1L)*sin(pi - theta_a + pi/2))/dm_a1L);
psi_a1L = -(beta_a1L - phi + theta);
%ms2L at (a1L + b1L) (upper shank)
dm_a1Lb1L = sqrt((a1L + b1L)^2 + d_a^2 + 2*(a1L + b1L)*d_a*sin(theta_a)); 
beta_a1Lb1L = -asin(((a1L + b1L)*sin(pi - theta_a + pi/2))/dm_a1Lb1L);
psi_a1Lb1L = -(beta_a1Lb1L - phi + theta);
%mt2L at (lsL + c2L) (lower thigh)
dm_lsLc2L = sqrt((lsL + c2L)^2 + d_a^2 + 2*(lsL + c2L)*d_a*sin(theta_a)); 
beta_lsLc2L = -asin(((lsL + c2L)*sin(pi - theta_a + pi/2))/dm_lsLc2L);
psi_lsLc2L = -(beta_lsLc2L - phi + theta);
%mt1L at (lsL + c2L + b2L) (upper thigh)
dm_lsLc2Lb2L = sqrt((lsL + c2L + b2L)^2 + d_a^2 + 2*(lsL + c2L + b2L)*d_a*sin(theta_a)); 
beta_lsLc2Lb2L = -asin(((lsL + c2L + b2L)*sin(pi - theta_a + pi/2))/dm_lsLc2Lb2L);
psi_lsLc2Lb2L = -(beta_lsLc2Lb2L - phi + theta);
%mh (hip mass)
dm_LL = sqrt(LL^2 + d_a^2 + 2*LL*d_a*sin(theta_a));                    
beta_LL = -asin((LL*sin(pi - theta_a + pi/2))/dm_LL);
psi_LL = -(beta_LL - phi + theta);
%ms1R at (a1R)
dm_a1R = sqrt(a1R^2 + d_a^2 + 2*a1R*d_a*sin(theta_a));                    
beta_a1R = -asin((a1R*sin(pi - theta_a + pi/2))/dm_a1R);
psi_a1R = -(beta_a1R - phi + theta);
%ms2R at (a1R + b1R)
dm_a1Rb1R = sqrt((a1R + b1R)^2 + d_a^2 + 2*(a1R + b1R)*d_a*sin(theta_a));                    
beta_a1Rb1R = -asin(((a1R + b1R)*sin(pi - theta_a + pi/2))/dm_a1Rb1R);
psi_a1Rb1R = -(beta_a1Rb1R - phi + theta);
%mt2R at (a1R + b1R + c1R + c2R) 
dm_lsRc2R = sqrt((a1R + b1R + c1R + c2R) ^2 + d_a^2 + 2*(a1R + b1R + c1R + c2R) *d_a*sin(theta_a)); 
beta_lsRc2R = -asin(((a1R + b1R + c1R + c2R) *sin(pi - theta_a + pi/2))/dm_lsRc2R);
psi_lsRc2R = -(beta_lsRc2R - phi + theta);
%mt1R at (a1R + b1R + c1R + c2R + b2R) 
dm_lsRc2Rb2R = sqrt((a1R + b1R + c1R + c2R + b2R)  ^2 + d_a^2 + 2*(a1R + b1R + c1R + c2R + b2R)  *d_a*sin(theta_a)); 
beta_lsRc2Rb2R = -asin(((a1R + b1R + c1R + c2R + b2R)  *sin(pi - theta_a + pi/2))/dm_lsRc2Rb2R);
psi_lsRc2Rb2R = -(beta_lsRc2Rb2R - phi + theta);
%mh at (LR)
dm_LR = sqrt(LR^2 + d_a^2 + 2*LR*d_a*sin(theta_a));                    
beta_LR = -asin((LR*sin(pi - theta_a + pi/2))/dm_LR);
psi_LR = -(beta_LR - phi + theta);









% %Curved Foot
% Qm11 = dm_LL*dm_LR*mh*cos(psi_LL - psi_LR) - a2L*dm_lsLc2Lb2L*mt1L*cos(psi_lsLc2Lb2L - q1) - b1L*dm_a1L*ms1L*cos(psi_a1L - q1) - b2L*dm_lsLc2L*mt2L*cos(psi_lsLc2L - q1) - c1L*dm_a1L*ms1L*cos(psi_a1L - q1) - c1L*dm_a1Lb1L*ms2L*cos(psi_a1Lb1L - q1) - a2L*dm_lsLc2L*mt2L*cos(psi_lsLc2L - q1) + dm_LR*dm_a1L*ms1L*cos(psi_LR - psi_a1L) + dm_LL*dm_a1R*ms1R*cos(psi_LL - psi_a1R) + dm_LR*dm_a1Lb1L*ms2L*cos(psi_LR - psi_a1Lb1L) + dm_LL*dm_a1Rb1R*ms2R*cos(psi_LL - psi_a1Rb1R) + dm_LR*dm_lsLc2L*mt2L*cos(psi_LR - psi_lsLc2L) + dm_LL*dm_lsRc2R*mt2R*cos(psi_LL - psi_lsRc2R) + dm_LR*dm_lsLc2Lb2L*mt1L*cos(psi_LR - psi_lsLc2Lb2L) + dm_LL*dm_lsRc2Rb2R*mt1R*cos(psi_LL - psi_lsRc2Rb2R) - dm_a1L*ltL*ms1L*cos(psi_a1L - q1) - dm_a1Lb1L*ltL*ms2L*cos(psi_a1Lb1L - q1);
% Qm12 = - dm_lsRc2R*mt2R*cos(psi_lsRc2R - q2)*(a2R + b2R) - dm_a1Rb1R*ms2R*cos(psi_a1Rb1R - q2)*(c1R + ltR) - a2R*dm_lsRc2Rb2R*mt1R*cos(psi_lsRc2Rb2R - q2) - dm_a1R*ms1R*cos(psi_a1R - q2)*(b1R + c1R + ltR);
% Qm21 = - dm_lsLc2L*mt2L*cos(psi_lsLc2L - q1)*(a2L + b2L) - dm_a1Lb1L*ms2L*cos(psi_a1Lb1L - q1)*(c1L + ltL) - a2L*dm_lsLc2Lb2L*mt1L*cos(psi_lsLc2Lb2L - q1) - dm_a1L*ms1L*cos(psi_a1L - q1)*(b1L + c1L + ltL);
% Qm22 = 0;
% 
% Qm2 = [Qm11, Qm12; Qm21, Qm22]
% 
% Qp11 = dm_LR^2*mh + dm_LR^2*ms1L + dm_LR^2*ms2L + dm_a1R^2*ms1R + dm_a1Rb1R^2*ms2R + dm_LR^2*mt1L + dm_LR^2*mt2L + dm_lsRc2R^2*mt2R + dm_lsRc2Rb2R^2*mt1R - a2L*dm_LR*mt1L*cos(psi_LR - q1) - a2L*dm_LR*mt2L*cos(psi_LR - q1) - b1L*dm_LR*ms1L*cos(psi_LR - q1) - b2L*dm_LR*mt2L*cos(psi_LR - q1) - c1L*dm_LR*ms1L*cos(psi_LR - q1) - c1L*dm_LR*ms2L*cos(psi_LR - q1) - dm_LR*ltL*ms1L*cos(psi_LR - q1) - dm_LR*ltL*ms2L*cos(psi_LR - q1);
% Qp12 = a2L^2*mt1L + a2L^2*mt2L + b1L^2*ms1L + b2L^2*mt2L + c1L^2*ms1L + c1L^2*ms2L + ltL^2*ms1L + ltL^2*ms2L + 2*a2L*b2L*mt2L + 2*b1L*c1L*ms1L + 2*b1L*ltL*ms1L + 2*c1L*ltL*ms1L + 2*c1L*ltL*ms2L - a2L*dm_LR*mt1L*cos(psi_LR - q1) - a2L*dm_LR*mt2L*cos(psi_LR - q1) - b1L*dm_LR*ms1L*cos(psi_LR - q1) - b2L*dm_LR*mt2L*cos(psi_LR - q1) - c1L*dm_LR*ms1L*cos(psi_LR - q1) - c1L*dm_LR*ms2L*cos(psi_LR - q1) - dm_LR*ltL*ms1L*cos(psi_LR - q1) - dm_LR*ltL*ms2L*cos(psi_LR - q1);
% Qp21 = -dm_LR*cos(psi_LR - q1)*(a2L*mt1L + a2L*mt2L + b1L*ms1L + b2L*mt2L + c1L*ms1L + c1L*ms2L + ltL*ms1L + ltL*ms2L);
% Qp22 = mt2L*(a2L + b2L)^2 + ms2L*(c1L + ltL)^2 + a2L^2*mt1L + ms1L*(b1L + c1L + ltL)^2;
% 
% Qp2 = [Qp11, Qp12; Qp21, Qp22]
% 
% 
% 
% 
% 
% %Point Foot
% Qm11= LL*mt2R*cos(q1 - q2)*(a1R + b1R + c1R + c2R) + LL*ms2R*cos(q1 - q2)*(a1R + b1R) - a1L*ms1L*cos(q1)*(cos(q1)*(a2L + b1L + b2L + c1L + c2L) - LR*cos(q2)) + mt1L*cos(q1)*(LR*cos(q2) - a2L*cos(q1))*(a1L + b1L + b2L + c1L + c2L) + LL*mt1R*cos(q1 - q2)*(a1R + b1R + b2R + c1R + c2R) + LL*LR*mh*cos(q1 - q2) + LL*a1R*ms1R*cos(q1 - q2) - a1L*ms1L*sin(q1)*(sin(q1)*(a2L + b1L + b2L + c1L + c2L) - LR*sin(q2)) + mt1L*sin(q1)*(LR*sin(q2) - a2L*sin(q1))*(a1L + b1L + b2L + c1L + c2L) - ms2L*cos(q1)*(a1L + b1L)*(cos(q1)*(a2L + b2L + c1L + c2L) - LR*cos(q2)) - mt2L*cos(q1)*(cos(q1)*(a2L + b2L) - LR*cos(q2))*(a1L + b1L + c1L + c2L) - ms2L*sin(q1)*(sin(q1)*(a2L + b2L + c1L + c2L) - LR*sin(q2))*(a1L + b1L) - mt2L*sin(q1)*(sin(q1)*(a2L + b2L) - LR*sin(q2))*(a1L + b1L + c1L + c2L);
% Qm12= - a1R*ms1R*(a2R + b1R + b2R + c1R + c2R) - a2R*mt1R*(a1R + b1R + b2R + c1R + c2R) - ms2R*(a1R + b1R)*(a2R + b2R + c1R + c2R) - mt2R*(a2R + b2R)*(a1R + b1R + c1R + c2R);
% Qm21= - a1L*ms1L*(a2L + b1L + b2L + c1L + c2L) - a2L*mt1L*(a1L + b1L + b2L + c1L + c2L) - ms2L*(a1L + b1L)*(a2L + b2L + c1L + c2L) - mt2L*(a2L + b2L)*(a1L + b1L + c1L + c2L);
% Qm22= 0;
% 
% Qm2=[Qm11,Qm12;Qm21,Qm22]
% 
% Qp11 = mt2R*(a1R + b1R + c1R + c2R)^2 + ms2R*(a1R + b1R)^2 + mt1R*(a1R + b1R + b2R + c1R + c2R)^2 + LR^2*mh + a1R^2*ms1R - LR*ms2L*sin(q2)*(sin(q1)*(a2L + b2L + c1L + c2L) - LR*sin(q2)) - LR*mt2L*cos(q2)*(cos(q1)*(a2L + b2L) - LR*cos(q2)) - LR*ms1L*cos(q2)*(cos(q1)*(a2L + b1L + b2L + c1L + c2L) - LR*cos(q2)) - LR*mt2L*sin(q2)*(sin(q1)*(a2L + b2L) - LR*sin(q2)) + LR*mt1L*cos(q2)*(LR*cos(q2) - a2L*cos(q1)) - LR*ms1L*sin(q2)*(sin(q1)*(a2L + b1L + b2L + c1L + c2L) - LR*sin(q2)) + LR*mt1L*sin(q2)*(LR*sin(q2) - a2L*sin(q1)) - LR*ms2L*cos(q2)*(cos(q1)*(a2L + b2L + c1L + c2L) - LR*cos(q2));
% Qp12 = mt2L*sin(q1)*(a2L + b2L)*(sin(q1)*(a2L + b2L) - LR*sin(q2)) + ms1L*cos(q1)*(cos(q1)*(a2L + b1L + b2L + c1L + c2L) - LR*cos(q2))*(a2L + b1L + b2L + c1L + c2L) - a2L*mt1L*cos(q1)*(LR*cos(q2) - a2L*cos(q1)) + ms1L*sin(q1)*(sin(q1)*(a2L + b1L + b2L + c1L + c2L) - LR*sin(q2))*(a2L + b1L + b2L + c1L + c2L) + ms2L*cos(q1)*(cos(q1)*(a2L + b2L + c1L + c2L) - LR*cos(q2))*(a2L + b2L + c1L + c2L) - a2L*mt1L*sin(q1)*(LR*sin(q2) - a2L*sin(q1)) + ms2L*sin(q1)*(sin(q1)*(a2L + b2L + c1L + c2L) - LR*sin(q2))*(a2L + b2L + c1L + c2L) + mt2L*cos(q1)*(a2L + b2L)*(cos(q1)*(a2L + b2L) - LR*cos(q2));
% Qp21 = -LR*cos(q1 - q2)*(a2L*ms1L + a2L*ms2L + a2L*mt1L + a2L*mt2L + b1L*ms1L + b2L*ms1L + b2L*ms2L + b2L*mt2L + c1L*ms1L + c1L*ms2L + c2L*ms1L + c2L*ms2L);
% Qp22 = ms2L*(a2L + b2L + c1L + c2L)^2 + mt2L*(a2L + b2L)^2 + ms1L*(a2L + b1L + b2L + c1L + c2L)^2 + a2L^2*mt1L;
% 
% Qp2=[Qp11,Qp12;Qp21,Qp22]


N31_qd_2 = (ms1R*(2*cos(q3)*(b1R + c1R)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*sin(q3)*(b1R + c1R)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2 + (ms2R*(2*c1R*cos(q3)*((cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) + 2*c1R*sin(q3)*((sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - asin((LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - ((LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1))/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)*(dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb) - 2*dL*rLb*cos(pi/2 + q1 - theta) - 2*rLb*(rLa + q1*rLb) + 2*LL*cos(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(((dL*cos(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) - (dL*sin(pi/2 + q1 - theta)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/(2*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (dL^2*sin(pi/2 + q1 - theta)^2)/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2) - 1)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + (LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*(2*rLb*(rLa + q1*rLb) + 2*dL*rLb*cos(pi/2 + q1 - theta) - dL*sin(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)))/(2*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(3/2)))/(1 - (LL^2*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - theta - q1)^2)/((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb)))^(1/2))*((rLa + q1*rLb)^2 + LL^2 + dL^2 - 2*LL*sin(asin((dL*sin(pi/2 + q1 - theta))/((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2)) - q1 - theta - pi/2)*((rLa + q1*rLb)^2 + dL^2 + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2) + dL*cos(pi/2 + q1 - theta)*(2*rLa + 2*q1*rLb))^(1/2))))/2

N31_qd_2 = (ms2L*(2*c1L*cos(q3)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*c1L*sin(q3)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2 + (ms1L*(2*cos(q3)*(b1L + c1L)*((cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) + 2*sin(q3)*(b1L + c1L)*((sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - asin((LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - ((LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1))/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)*(dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb) - 2*dR*rRb*cos(pi/2 + q1 - theta) - 2*rRb*(rRa + q1*rRb) + 2*LR*cos(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(((dR*cos(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) - (dR*sin(pi/2 + q1 - theta)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/(2*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (dR^2*sin(pi/2 + q1 - theta)^2)/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2) - 1)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + (LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*(2*rRb*(rRa + q1*rRb) + 2*dR*rRb*cos(pi/2 + q1 - theta) - dR*sin(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)))/(2*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(3/2)))/(1 - (LR^2*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - theta - q1)^2)/((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb)))^(1/2))*((rRa + q1*rRb)^2 + LR^2 + dR^2 - 2*LR*sin(asin((dR*sin(pi/2 + q1 - theta))/((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2)) - q1 - theta - pi/2)*((rRa + q1*rRb)^2 + dR^2 + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2) + dR*cos(pi/2 + q1 - theta)*(2*rRa + 2*q1*rRb))^(1/2))))/2



